# 仕様書 → tasks 変換ガイド

## 変換の原則

1つの受け入れ条件（AC）を1つのタスクに変換するのが基本単位。
ただし、ACが大きすぎる場合は分割、小さすぎる場合は統合する。

## タスクのサイズ目安

| サイズ | 目安 | 例 |
|--------|------|-----|
| S | 1-2時間 | 型定義の作成、設定ファイルの追加、単一コンポーネントの実装 |
| M | 半日〜1日 | 1画面の実装、API連携の実装、認証フローの1機能 |
| L | 1-2日 | 複数画面にまたがる機能、複雑なビジネスロジック |

Lを超えるものは分割すること。

## タスク記述フォーマット

```
タスク名: [動詞]する - [対象]
参照仕様: specs/features/[name].md#AC-[N]
担当Agent: Agent [X]
依存: [タスクID] （なければ「なし」）
完了条件:
  - [仕様書のACをそのまま転記]
  - [テストが通ること]
サイズ: S/M/L
```

## フェーズ分けの基準

### Phase 0: 基盤（全タスクの前提）
以下は全Agentが作業を始める前に完了する必要がある：
- プロジェクト初期化（Expo init, 依存関係インストール）
- shared/types/ の型定義
- shared/hooks/ のインターフェース定義（実装はスタブでOK）
- ナビゲーション構造のスケルトン
- CLAUDE.md の配置

### Phase 1: 基盤機能
認証と課金の基盤。他の機能がこれに依存するため先に作る：
- 認証フロー（サインアップ、ログイン、ログアウト）
- RevenueCat SDK導入 + Offering設定
- useSubscription hook の実装
- ペイウォール画面（仮UI）

### Phase 2: コア機能（並列実行）
各AgentがそれぞれのMVP機能を並列実装：
- コア機能のビジネスロジック
- 各画面の実装
- オンボーディングフロー

### Phase 3: 統合・最適化
機能を繋ぎ合わせ、課金フローを磨く：
- 機能間の統合テスト
- ペイウォールUIの本実装
- RevenueCat Experiments設定
- アナリティクスイベントの実装

### Phase 4: リリース準備
- E2Eテスト（課金フローは必須）
- App Store / Google Play 申請準備
- ASO基本設定

## 依存関係の記述ルール

- Phase 0 のタスクは依存なし（最初に実行）
- Phase 1 のタスクは Phase 0 完了に依存
- Phase 2 のタスクは Phase 1 の該当機能に依存
- Phase 3 のタスクは Phase 2 の関連タスクに依存
- Phase 4 のタスクは Phase 3 完了に依存

同一Phase内でも依存がある場合は明記する。

## tasks コマンドへの変換例

仕様書の受け入れ条件：
```
### AC-1: メールでサインアップできる
- Given: 未認証ユーザー
- When: メールとパスワードを入力してサインアップボタンを押す
- Then: アカウントが作成され、オンボーディング画面に遷移する
```

変換結果：
```bash
claude tasks add "実装する - メールサインアップ機能" \
  --spec "specs/features/auth.md#AC-1" \
  --agent "Agent A" \
  --depends-on "Phase0-shared-types" \
  --size "M"
```

## Agent別タスク一覧の出力形式

最終的に、以下の形式でユーザーに提示する：

```
━━━━━━━━━━━━━━━━━━━━━━
Agent A: 認証 + ユーザー管理
━━━━━━━━━━━━━━━━━━━━━━
Phase 1:
  [M] 実装する - メールサインアップ機能
  [M] 実装する - ソーシャルログイン（Apple/Google）
  [S] 実装する - ログアウト機能
Phase 2:
  [M] 実装する - プロフィール編集画面

━━━━━━━━━━━━━━━━━━━━━━
Agent B: コア機能
━━━━━━━━━━━━━━━━━━━━━━
Phase 2:
  [L] 実装する - [メイン機能]
  [M] 実装する - [サブ機能]
...

合計: X tasks (S: x, M: x, L: x)
クリティカルパス: Phase 0 → Phase 1認証 → Phase 2コア → Phase 3統合
推定期間: X週間
```
